FROM bardend123/hdfs-hadoop-spark-base:v2

ARG SPARK_MASTER_PORT
ARG SPARK_MASTER_WEBUI_PORT
ARG SPARK_MASTER_HOST
ARG SPARK_HOME
ARG DIR_VOL_NAMENODE
ARG MASTER_HOST

ENV SPARK_MASTER_PORT=${SPARK_MASTER_PORT}
ENV SPARK_MASTER_WEBUI_PORT=${SPARK_MASTER_WEBUI_PORT}
ENV SPARK_HOME=${SPARK_HOME}
ENV SPARK_MASTER_LOG=${SPARK_HOME}/logs
ENV SPARK_MASTER_HOST=${SPARK_MASTER_HOST}
ENV MASTER_HOST=${MASTER_HOST}
ENV DIR_VOL_NAMENODE=${DIR_VOL_NAMENODE}
ENV HDFS_CONF_NAMENODE_DIR=file://${DIR_VOL_NAMENODE}

RUN mkdir -p "${DIR_VOL_NAMENODE}"

COPY run.sh /run.sh
RUN chmod +x /run.sh

# Puertos Spark Master
EXPOSE ${SPARK_MASTER_WEBUI_PORT} ${SPARK_MASTER_PORT}
# Puertos HDFS NameNode
#EXPOSE 9870 8020

CMD ["/run.sh"]